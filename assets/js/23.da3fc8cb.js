(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{533:function(n,t,s){n.exports=s.p+"assets/img/20210325174022.4e6e40c6.png"},534:function(n,t,s){n.exports=s.p+"assets/img/20210325174058.4563b0c2.png"},626:function(n,t,s){"use strict";s.r(t);var e=s(4),a=Object(e.a)({},(function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h2",{attrs:{id:"效果展示"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#效果展示"}},[n._v("#")]),n._v(" 效果展示")]),n._v(" "),e("p",[e("strong",[n._v("点击按钮前：")])]),n._v(" "),e("p",[e("img",{attrs:{src:s(533),alt:""}})]),n._v(" "),e("p",[e("strong",[n._v("点击按钮后：")])]),n._v(" "),e("p",[e("img",{attrs:{src:s(534),alt:""}})]),n._v(" "),e("h2",{attrs:{id:"主要脚本内容"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#主要脚本内容"}},[n._v("#")]),n._v(" "),e("strong",[n._v("主要脚本内容")])]),n._v(" "),e("div",{staticClass:"language-vbscript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("Private Sub CommandButton1_Click()\n  Dim mypath As String\n  Dim myExtension As String\n  Dim myFiles As String\n  Dim thisWb As Worksheet\n  Dim wb As Workbook\n  Dim I&, Rm&\n  \n  '设置一些属性\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n  \n  Set thisWb = ThisWorkbook.Worksheets(1) '当前工作簿\n  \n  mypath = ThisWorkbook.Path & \"\\data\\\" '指定文件夹路径\n \n  myExtension = \"*.xls\"  '指定过滤的文件后缀\n  \n  myFiles = Dir(mypath & myExtension)  '所有指定后缀的文件\n\n  '循环处理每一个文件\n  Do While myFiles <> \"\"\n  \n     Set wb = Application.Workbooks.Open(Filename:=mypath & myFiles) '打开\n     \n    '确保工作簿被打开，在处理下一个文件时\n     DoEvents\n     \n     \n     Rm = Cells.Rows.Count  '当前活动工作表的行数\n     With wb.Worksheets(1)\n         For I = 2 To .Range(\"A\" & Rm).End(3).Row  '←为1也表示xlToLeft，→为2也表示xlToRight，↑为3也表示xlUp，↓为4也表示xlDown\n              .Rows(I).Copy thisWb.Range(\"A\" & Rm).End(3).Offset(1)\n         Next\n            \n     End With\n  \n     wb.Close 'SaveChanges:=True '保存工作簿\n     '确保工作簿被关闭，在处理下一个文件时\n     DoEvents\n     '接着处理下一个\n     myFiles = Dir\n    \n  Loop\n  \n  '恢复设置\n  Application.EnableEvents = True\n  Application.Calculation = xlCalculationAutomatic\n  Application.ScreenUpdating = True\n  \n  MsgBox (\"汇总完成！\")\nEnd Sub\n")])])]),e("p",[e("em",[n._v("参考：")])]),n._v(" "),e("p",[n._v("[1].案例文档,"),e("a",{attrs:{href:n.$withBase("/file/vba-collect-files.zip"),download:"vba-collect-files.zip"}},[n._v("点击下载")])])])}),[],!1,null,null,null);t.default=a.exports}}]);