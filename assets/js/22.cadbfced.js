(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{533:function(s,t,e){"use strict";e.r(t);var a=e(4),n=Object(a.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"前言"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),e("p",[e("strong",[s._v("目标")]),s._v("：在三台机器上安装Redis（一个主，两个从），并启动三个哨兵（多哨兵模式可以有效地防止单哨兵不可用的情况）。")]),s._v(" "),e("p",[e("strong",[s._v("环境清单")])]),s._v(" "),e("ul",[e("li",[s._v("CentOS Linux 7 (Core)\nKernel 3.10.0-1127.el7.x86_64 on an x86_64")]),s._v(" "),e("li",[s._v("Redis 5.0.3")])]),s._v(" "),e("p",[e("strong",[s._v("服务分配清单")])]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("服务进程类型")]),s._v(" "),e("th",[s._v("是否Redis主服务器")]),s._v(" "),e("th",[s._v("IP地址")]),s._v(" "),e("th",[s._v("服务端口号")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("Redis")]),s._v(" "),e("td",[s._v("是")]),s._v(" "),e("td",[s._v("172.26.11.89")]),s._v(" "),e("td",[s._v("6379")])]),s._v(" "),e("tr",[e("td",[s._v("Redis")]),s._v(" "),e("td",[s._v("否")]),s._v(" "),e("td",[s._v("172.26.11.90")]),s._v(" "),e("td",[s._v("6379")])]),s._v(" "),e("tr",[e("td",[s._v("Redis")]),s._v(" "),e("td",[s._v("否")]),s._v(" "),e("td",[s._v("172.26.11.91")]),s._v(" "),e("td",[s._v("6379")])]),s._v(" "),e("tr",[e("td",[s._v("Sentinel")]),s._v(" "),e("td",[s._v("—")]),s._v(" "),e("td",[s._v("172.26.11.89")]),s._v(" "),e("td",[s._v("26379")])]),s._v(" "),e("tr",[e("td",[s._v("Sentinel")]),s._v(" "),e("td",[s._v("—")]),s._v(" "),e("td",[s._v("172.26.11.90")]),s._v(" "),e("td",[s._v("26379")])]),s._v(" "),e("tr",[e("td",[s._v("Sentinel")]),s._v(" "),e("td",[s._v("—")]),s._v(" "),e("td",[s._v("172.26.11.91")]),s._v(" "),e("td",[s._v("26379")])])])]),s._v(" "),e("p",[s._v("注意：如果安装后需要在本地测试，不要忘记关闭防火墙或者开放服务端口。")]),s._v(" "),e("h2",{attrs:{id:"安装redis"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装redis"}},[s._v("#")]),s._v(" 安装Redis")]),s._v(" "),e("h3",{attrs:{id:"下载"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#下载"}},[s._v("#")]),s._v(" 下载")]),s._v(" "),e("p",[s._v("redis官网地址：http://www.redis.io/")]),s._v(" "),e("p",[s._v("下载地址：http://download.redis.io/releases/")]),s._v(" "),e("p",[s._v("redis中文文档地址：http://www.redis.cn/documentation.html")]),s._v(" "),e("p",[s._v("使用命令下载：")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://download.redis.io/releases/redis-5.0.3.tar.gz\n")])])]),e("p",[s._v("如果linux中没有wget命令，就用如下命令安装（在根目录下执行）：")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("yum -y "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v("\n")])])]),e("h3",{attrs:{id:"安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),e("p",[s._v("1、解压下载完成的源码（我这里下载到/home/centos目录下），编译。")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost centos"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar xzf redis-5.0.3.tar.gz")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost centos"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /home/centos/redis-5.0.3")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost redis-5.0.3"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make")]),s._v("\n")])])]),e("p",[s._v("2、如果没有安装gcc，需要安装。")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost redis-5.0.3"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum -y install gcc")]),s._v("\n")])])]),e("p",[s._v("验证是否安装成功")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost redis-5.0.3"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rpm -qa|grep gcc")]),s._v("\ngcc-4.8.5-39.el7.x86_64\nlibgcc-4.8.5-39.el7.x86_64\n")])])]),e("p",[s._v("3、继续执行make命令编译源码。")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost redis-5.0.3"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make")]),s._v("\n")])])]),e("p",[s._v("可能出现错误："),e("span",{staticStyle:{color:"red"}},[s._v("致命错误:jemalloc/jemalloc.h:没有那个文件或目录")])]),s._v(" "),e("p",[s._v("原来redis在内存分配上默认用的是jemalloc,jemalloc是管理内存碎片的")]),s._v(" "),e("p",[s._v("有兴趣的可以参考下这个博客：https://blog.csdn.net/xiaofei_hah0000/article/details/52214592")]),s._v(" "),e("p",[s._v("我们测试的话用这个")]),s._v(" "),e("p",[s._v("执行命令：make MALLOC=libc")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost redis-5.0.3"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make MALLOC=libc")]),s._v("\n")])])]),e("p",[s._v("当出现"),e("code",[s._v("Hint:It's a good idea to run 'make test'")]),s._v("是代表make成功。")]),s._v(" "),e("p",[s._v("4、执行make install命令安装")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost redis-5.0.3"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd src/")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost src"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make install PREFIX=/usr/local/redis")]),s._v("\n")])])]),e("p",[s._v("我们可以增加PREFIX参数，这样可以将其安装到指定的目录中（/usr/local/redis）。")]),s._v(" "),e("p",[s._v("5、执行make test")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost src"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make test")]),s._v("\n")])])]),e("p",[s._v("提示需要安装tcl，这里直接使用yum安装")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost src"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum -y install tcl")]),s._v("\n")])])]),e("p",[s._v("再次执行make test，等待完成"),e("code",[s._v("All test passed without errors!")]),s._v("安装完成。")]),s._v(" "),e("h2",{attrs:{id:"配置主从和哨兵"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置主从和哨兵"}},[s._v("#")]),s._v(" 配置主从和哨兵")]),s._v(" "),e("p",[s._v("1、复制配置文件")]),s._v(" "),e("p",[s._v("复制下载目录（/home/centos/redis-5.0.3）下的redis.conf和sentinel.conf文件到我们的安装目录(/usr/local/redis)的bin目录下：")]),s._v(" "),e("ul",[e("li",[s._v("redis.conf：redis的配置文件")]),s._v(" "),e("li",[s._v("sentinel.conf：redis哨兵模式启动的配置文件")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /home/centos/redis/redis-5.0.3/redis.conf     /usr/local/redis/bin\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /home/centos/redis/redis-5.0.3/sentinel.conf  /usr/local/redis/bin\n")])])]),e("p",[s._v("2、配置redis.conf")]),s._v(" "),e("p",[s._v("主服务器：172.26.11.89:6379")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /usr/local/redis/bin/redis.conf \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查找daemonize no改为 yes以守护进程方式运行 即以后台运行方式去启动")]),s._v("\ndaemonize "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v(" \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改dir ./为绝对路径, 默认的话redis-server启动时会在当前目录生成或读取dump.rdb 所以如果在根目录下执行redis-server /etc/redis.conf的话#, 读取的是根目录下的dump.rdb,为了使redis-server可在任意目录下执行 所以此处将dir改为绝对路径 ")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("dir")]),s._v(" /usr/local/redis-5.0.3/bin\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改appendonly为yes ")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指定是否在每次更新操作后进行日志记录， Redis在默认情况下是异步的把数据写入磁盘， ")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果不开启，可能会在断电时导致一段时间内的数据丢失。 因为 redis本身同步数据文件是按上面save条件来同步的， ")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#所以有的数据会在一段时间内只存在于内存中。默认为no ")]),s._v("\nappendonly "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v(" \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#redis 日志生成位置(可能需要手动创建一下这个文件)")]),s._v("\nlogfile "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/app/log/redis.log"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 禁用保护模式(测试时为了方便，直接关闭)")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redis3.2版本后新增protected-mode配置，默认是yes，即开启。设置外部网络连接redis服务，设置方式如下：")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1、关闭protected-mode模式，此时外部网络可以直接访问")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2、开启protected-mode保护模式，需配置bind ip或者设置访问密码")]),s._v("\nprotected-mode no\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改可以访问的IP(为了方便，直接设置为0.0.0.0代表可以任意IP跨域访问)")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("bind")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置Redis服务密码")]),s._v("\nrequirepass "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n")])])]),e("p",[s._v("从服务器：172.26.11.90:6379和172.26.11.91:6379")]),s._v(" "),e("p",[s._v("其它配置和主服务器一样，增加两个配置项：")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置从哪里复制数据（也就是配置主服务器）")]),s._v("\nreplicaof "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.26")]),s._v(".11.89 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置主Redis服务器密码(也就是主服务器的requirepass)")]),s._v("\nmasterauth "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n")])])]),e("p",[e("span",{staticStyle:{color:"green"}},[s._v("此时已经完成了Redis服务器的主从配置，我们还需要配置哨兵。")]),s._v(">")]),s._v(" "),e("p",[s._v("3、配置sentinel.conf")]),s._v(" "),e("p",[s._v("三个哨兵服务的配置均作如下修改：")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查找daemonize no改为 yes以守护进程方式运行 即以后台运行方式去启动")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 第一次测试的时候可以先不开，以便可以直接观察主从和哨兵模式的相关信息")]),s._v("\ndaemonize "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v(" \n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 禁用保护模式(测试时为了方便，直接关闭)")]),s._v("\nprotected-mode no\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置监听的主服务器，这里sentinel monitor 代表监控，")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mymaster 代表服务器名称，可以自定义")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 172.26.11.89 6379代表监控的主服务器IP和端口")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2 代表只有在2个或者2个以上的哨兵认为主服务器不可用的时候，才进行客观下线")]),s._v("\nsentinel monitor mymaster "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.26")]),s._v(".11.89 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sentinel auth-pass 定义服务的密码")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mymaster 服务名称")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 123456 Redis服务器密码")]),s._v("\nsentinel auth-pass mymaster "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n")])])]),e("h2",{attrs:{id:"启动和测试"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动和测试"}},[s._v("#")]),s._v(" 启动和测试")]),s._v(" "),e("p",[s._v("进入Redis安装目录启动，"),e("span",{staticStyle:{color:"red"}},[s._v("需要注意启动顺序，首先是主Redis服务器，然后是从Redis服务器，最后才是3个哨兵。")]),s._v("启动之后，观察最后一个启动的哨兵，可以看到主从服务器和哨兵的相关信息，说们我们的多哨兵配置正确，搭建完成。")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动Redis 服务")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost /"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd ./usr/local/redis/bin")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost bin"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./redis-server redis.conf ")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动哨兵进程服务")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost bin"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./redis-sentinel sentinel.conf")]),s._v("\n")])])]),e("p",[s._v("可以在主服务器上启动一个客户端进行测试，也可以在本地上安装一个"),e("code",[s._v("Another Redis Desktop Manager")]),s._v("测试。")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost bin"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./redis-cli ")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" auth "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\nOK\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" key3 value3\nOK\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" get key3\n"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"value3"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n")])])]),e("p",[s._v("使用命令"),e("code",[s._v("ps aux | grep redis")]),s._v(" 查看是否启动成功正在运行。")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost bin"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ps aux | grep redis")]),s._v("\nroot      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2289")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("112808")]),s._v("   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("964")]),s._v(" ttyS0    S+   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":55   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":00 "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" --color"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("auto redis\nroot     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("14508")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("145384")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3528")]),s._v(" ?        Ssl  Aug25   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(":14 ./redis-server "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:6379\nroot     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("14720")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("144240")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2220")]),s._v(" ?        Ssl  Aug25   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(":11 ./redis-sentinel *:26379 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sentinel"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),e("h2",{attrs:{id:"停止与关闭"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#停止与关闭"}},[s._v("#")]),s._v(" 停止与关闭")]),s._v(" "),e("p",[s._v("停止redis-server，"),e("code",[s._v("./redis-cli -a 密码 shutdown")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("./redis-cli -a "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("shutdown")]),s._v("\n")])])]),e("p",[s._v("也可以直接"),e("code",[s._v("kill -9 PID")]),s._v("杀掉进程。")]),s._v(" "),e("h2",{attrs:{id:"本地无法连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#本地无法连接"}},[s._v("#")]),s._v(" 本地无法连接")]),s._v(" "),e("p",[s._v("本地代码中或者RedisDesktopManager等其它工具无法连接redis解决:")]),s._v(" "),e("p",[s._v("1.查看redis.conf配置文件: 设置protected-mode为 no")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("关闭protected-mode模式，此时外部网络可以直接访问")])]),s._v(" "),e("li",[e("p",[s._v("开启protected-mode保护模式，需配置bind ip或者设置访问密码")])])]),s._v(" "),e("p",[s._v("2.开放服务器端口: 管理防火墙/开发端口，如果是云服务器需要配置安全组规则。")]),s._v(" "),e("h2",{attrs:{id:"参考"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("《Spring Cloud 微服务和分布式系统实践》，杨开振著")])]),s._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://www.cnblogs.com/xyinjie/p/9444280.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Linux中Redis的安装"),e("OutboundLink")],1)])]),s._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://www.jianshu.com/p/cc0b2e708b63",target:"_blank",rel:"noopener noreferrer"}},[s._v("Linux redis sentinel 哨兵开机启动"),e("OutboundLink")],1)])])])])}),[],!1,null,null,null);t.default=n.exports}}]);